[gd_scene load_steps=4 format=1]

[ext_resource path="res://graphics/player/Player-dummy2.png" type="Texture" id=1]

[sub_resource type="ConvexPolygonShape2D" id=1]

custom_solver_bias = 0.0
points = Vector2Array( -16, -16, 16, -16, 16, 16, -16, 16 )

[sub_resource type="GDScript" id=2]

script/source = "extends KinematicBody2D

var mVelocity
var mAnimals
var mParticles

func set_velocity(pos):
	set_global_pos(Vector2(x - 40, get_global_pos().y))

func _fixed_process(delta):
	if (!is_colliding()):
		mVelocity.y += globals.GRAVITY
	else:
		if (mVelocity.x != 0):
			mParticles.set_amount(mVelocity.x * 0.1)
		else:
			mParticles.set_amount(0)
		mVelocity.y = 0
	
#	if (get_pos().distance_to(mAnimals.get_pos()) > 1):
#		mVelocity.x = mAnimals.mVelocity.x
	
	var motion = mVelocity * delta
	var mx = motion.x
	motion = move(motion)
	
	if (is_colliding()):
		var n = get_collision_normal()
		if (n.y != -1):
			motion.y = n.slide(motion).y
			mVelocity.y = n.slide(mVelocity).y
		
		move(Vector2(0, motion.y))
	
func _ready():
	mAnimals = get_parent().get_node(\"Animals\")
	mParticles = get_node(\"Particles2D\")
	mVelocity = Vector2()
	set_fixed_process(true)"

[node name="Sledge" type="KinematicBody2D"]

input/pickable = false
shapes/0/shape = SubResource( 1 )
shapes/0/transform = Matrix32( 1, 0, 0, 1, 0, 0 )
shapes/0/trigger = false
collision/layers = 1
collision/mask = 1
collision/margin = 0.08
script/script = SubResource( 2 )

[node name="Sprite" type="Sprite" parent="."]

texture = ExtResource( 1 )

[node name="CollisionPolygon2D" type="CollisionPolygon2D" parent="."]

build_mode = 0
polygon = Vector2Array( -16, -16, 16, -16, 16, 16, -16, 16 )
shape_range = Vector2( 0, 0 )
trigger = false

[node name="Particles2D" type="Particles2D" parent="."]

visibility/visible = false
transform/pos = Vector2( 16, 16 )
transform/rot = -90.0
config/amount = 32
config/lifetime = 2.0
config/time_scale = 2.0
config/process_mode = 1
config/local_space = false
params/direction = 0.3
params/spread = 20.0
params/linear_velocity = 40.0
params/spin_velocity = 0.0
params/orbit_velocity = 0.0
params/gravity_direction = 0.0
params/gravity_strength = 9.8
params/radial_accel = 0.0
params/tangential_accel = 0.0
params/damping = 0.0
params/initial_angle = 0.0
params/initial_size = 4.0
params/final_size = 1.0
params/hue_variation = 0.0
params/anim_speed_scale = 1.0
params/anim_initial_pos = 0.0


